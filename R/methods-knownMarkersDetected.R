#' Known Markers Detected
#'
#' @rdname knownMarkersDetected
#' @name knownMarkersDetected
#'
#' @param object All markers [data.frame] generated by
#'   [Seurat::FindAllMarkers()].
#' @param knownMarkers Known markers imported by [readKnownMarkers()].
#' @param show Show [kable].
#'
#' @return [tibble].
NULL



# Constructors ====
.knownMarkersDetected <- function(object, knownMarkers, show = FALSE) {
    markers <- .groupMarkers(object) %>%
        left_join(knownMarkers, by = "symbol") %>%
        filter(!is.na(.data[["cellType"]]))
    if (isTRUE(show)) {
        kable(markers, caption = "Known markers detected") %>% show
    }
    markers
}



# Methods ====
#' @rdname knownMarkersDetected
#' @export
setMethod(
    "knownMarkersDetected",
    signature(object = "data.frame", knownMarkers = "tbl_df"),
    .knownMarkersDetected)
